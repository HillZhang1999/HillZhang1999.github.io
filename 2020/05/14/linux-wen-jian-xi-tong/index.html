<!DOCTYPE HTML>
<html lang="zh-CN">


<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta name="keywords" content="Linux文件系统, 章岳 学习笔记 计算机 算法 程序">
    <meta name="baidu-site-verification" content="fmlEuI34ir">
    <meta name="google-site-verification" content="yCy2azpds5XSuGZvis6OuA-XIGF5GuGpYRAaGfD6o48">
    <meta name="360-site-verification" content="b7c11a830ef90fd1464ad6206bb7b6e7">
    <meta name="description" content="Linux文件系统管理Linux文件系统概述Linux下的所有文件和目录以一个树状的结构组织构成了 Linux 中的文件系统。

Linux文件系统标准（Linux File System Standard，FSSTND） 
文件系统层次结">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Linux文件系统 | HillZhang的博客</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="//stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    <style type="text/css">
        
    </style>

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
    <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?46e79e71af0709a5b9106bf20cecc493";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

    
        <script>
            (function(){
                var bp = document.createElement('script');
                var curProtocol = window.location.protocol.split(':')[0];
                if (curProtocol === 'https') {
                    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
                }
                else {
                    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                }
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(bp, s);
            })();
        </script>
    

    <script>
        (function(){
        var src = "https://jspassport.ssl.qhimg.com/11.0.1.js?d182b3f28525f2db83acfaaf6e696dba";
        document.write('<script src="' + src + '" id="sozz"><\/script>');
        })();
    </script>

<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body>

    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">HillZhang的博客</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>首页</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/tags" class="waves-effect waves-light">
            
            <i class="fa fa-tags"></i>
            
            <span>标签</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>分类</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>归档</span>
        </a>
    </li>
    
    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">
            <i id="searchIcon" class="fa fa-search" title="搜索"></i>
        </a>
    </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">HillZhang的博客</div>
        <div class="logo-desc">
            
            苏州大学 | 计算机科学与技术学院 | 软件工程
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-home"></i>
                
                首页
            </a>
        </li>
        
        <li>
            <a href="/tags" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-tags"></i>
                
                标签
            </a>
        </li>
        
        <li>
            <a href="/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-bookmark"></i>
                
                分类
            </a>
        </li>
        
        <li>
            <a href="/archives" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-archive"></i>
                
                归档
            </a>
        </li>
        
        
    </ul>
</div>

        </div>

        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/17.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        Linux文件系统
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 20px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                        <a href="/tags/Linux/" target="_blank">
                            <span class="chip bg-color">Linux</span>
                        </a>
                        
                        <a href="/tags/操作系统/" target="_blank">
                            <span class="chip bg-color">操作系统</span>
                        </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fa fa-bookmark fa-fw icon-category"></i>
                        
                        <a href="/categories/Linux/" class="post-category" target="_blank">
                            Linux
                        </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                <div class="post-date info-break-policy">
                    <i class="fa fa-calendar-minus-o fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2020-05-14
                </div>

                <div class="post-author info-break-policy">
                    <i class="fa fa-user-o fa-fw"></i>作者:&nbsp;&nbsp;
                    
                    HillZhang
                    
                </div>

                
                
                <div class="info-break-policy">
                    <i class="fa fa-file-word-o fa-fw"></i>文章字数:&nbsp;&nbsp;
                    5.7k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="fa fa-clock-o fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    21 分
                </div>
                
                

                
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="Linux文件系统管理"><a href="#Linux文件系统管理" class="headerlink" title="Linux文件系统管理"></a>Linux文件系统管理</h1><h2 id="Linux文件系统概述"><a href="#Linux文件系统概述" class="headerlink" title="Linux文件系统概述"></a>Linux文件系统概述</h2><p>Linux下的所有文件和目录以一个<strong>树状</strong>的结构组织构成了 Linux 中的文件系统。</p>
<ul>
<li>Linux文件系统标准（Linux File System Standard，FSSTND） </li>
<li>文件系统层次结构标准（File System Hierarchy Standard，FHS） </li>
</ul>
<p>Linux常见的文件目录含义为：</p>
<p><strong>系统启动必须：</strong></p>
<ul>
<li><p><strong>/boot：</strong>存放的启动Linux 时使用的<strong>内核</strong>文件，包括连接文件以及镜像文件。</p>
</li>
<li><p><strong>/etc：</strong>存放<strong>所有</strong>的系统需要的<strong>配置文件</strong>和<strong>子目录列表，</strong>更改目录下的文件可能会导致系统不能启动。</p>
</li>
<li><p><strong>/lib</strong>：存放<strong>基本代码库</strong>（比如c++库），其作用类似于Windows里的<strong>DLL文件</strong>。几乎所有的应用程序都需要用到这些共享库。</p>
</li>
<li><p><strong>/sys</strong>： 这是linux2.6内核的一个很大的变化。该目录下安装了2.6内核中新出现的一个文件系统 sysfs 。sysfs文件系统集成了下面3种文件系统的信息：<strong>针对进程信息的proc文件系统、针对设备的devfs文件系统以及针对伪终端的devpts文件系统</strong>。该文件系统是<strong>内核设备树</strong>的一个直观反映。当一个内核对象被创建的时候，对应的文件和目录也在内核对象子系统中</p>
</li>
</ul>
<p><strong>指令集合：</strong></p>
<ul>
<li><p><strong>/bin：</strong>存放着最常用的<strong>程序和指令</strong></p>
</li>
<li><p><strong>/sbin：</strong>只有<strong>系统管理员</strong>能使用的程序和指令。</p>
</li>
</ul>
<p><strong>外部文件管理：</strong></p>
<ul>
<li><p><strong>/dev ：</strong>Device(设备)的缩写, 存放的是Linux的外部设备。<strong>注意：</strong>在Linux中访问设备和访问文件的方式是相同的。</p>
</li>
<li><p><strong>/media</strong>：类windows的<strong>其他设备，</strong>例如U盘、光驱等等，识别后linux会把设备放到这个目录下。</p>
</li>
<li><p><strong>/mnt</strong>：<strong>临时挂载</strong>别的文件系统的，我们可以将光驱挂载在/mnt/上，然后进入该目录就可以查看光驱里的内容了。</p>
</li>
</ul>
<p><strong>临时文件：</strong></p>
<ul>
<li><p><strong>/run</strong>：是一个<strong>临时</strong>文件系统，存储<strong>系统启动以来的信息</strong>。当系统重启时，这个目录下的文件应该被删掉或清除。如果你的系统上有 /var/run 目录，应该让它指向 run。</p>
</li>
<li><p><strong>/lost+found</strong>：一般情况下为空的，系统<strong>非法关机</strong>后，这里就存放一些文件。</p>
</li>
<li><p><strong>/tmp</strong>：这个目录是用来存放一些<strong>临时文件</strong>的。</p>
</li>
</ul>
<p><strong>账户：</strong></p>
<ul>
<li><strong>/root</strong>：<strong>系统管理员</strong>的用户主目录。</li>
<li><strong>/home</strong>：<strong>用户</strong>的主目录，以用户的账号命名的。类似于windows下的<strong>users目录。</strong></li>
<li><strong>/usr</strong>：用户的很多应用程序和文件都放在这个目录下，类似于windows下的<strong>program files目录</strong>。</li>
<li><strong>/usr/bin：系统用户</strong>使用的应用程序与指令。</li>
<li><strong>/usr/sbin：超级用户</strong>使用的比较高级的管理程序和系统守护程序。</li>
<li><strong>/usr/src：</strong>内核<strong>源代码</strong>默认的放置目录。</li>
</ul>
<p>（ /bin和/usr/bin目录的区别：</p>
<p>1）/bin,/sbin目录是在系统启动后挂载到根文件系统中的，所以/sbin,/bin目录必须和根文件系统在同一分区；</p>
<p>2）  /usr/bin,usr/sbin可以和根文件系统不在一个分区。）</p>
<p><strong>运行过程中要用：</strong></p>
<ul>
<li><p><strong>/var</strong>：存放经常修改的数据，比如程序运行的日志文件（/var/log 目录下）。（variable）</p>
</li>
<li><p><strong>/proc</strong>：管理<strong>内存空间！</strong>虚拟的目录，是<strong>系统内存的映射</strong>，我们可以直接访问这个目录来，获取系统信息。这个目录的内容不在硬盘上而是在内存里，我们也可以直接修改里面的某些文件来做修改。（process，进程）</p>
</li>
</ul>
<p><strong>扩展用的：</strong></p>
<ul>
<li><p><strong>/opt</strong>：默认是空的，我们安装额外软件可以放在这个里面。</p>
</li>
<li><p><strong>/srv</strong>：存放服务启动后需要提取的数据<strong>（不用服务器就是空）</strong></p>
</li>
</ul>
<h2 id="Linux支持的文件系统"><a href="#Linux支持的文件系统" class="headerlink" title="Linux支持的文件系统"></a>Linux支持的文件系统</h2><p>Linux的内核采用了称之为<strong>虚拟文件系统（Virtual File System，VFS）</strong>的技术，因此 Linux 可以支持多种不同的文件系统类型。（类似于虚拟设备）</p>
<p>Linux可支持的文件系统有：</p>
<ul>
<li>Linux目前几乎支持所有的<strong>UNIX类</strong>的文件系统，如 HFS、XFS、JFS、Minix FS 及 UFS 等</li>
<li>Linux 支持 <strong>NFS 文件系统</strong></li>
<li>Linux 也支持 <strong>NTFS 和 vfat（FAT32）</strong>（Windows下常用）</li>
</ul>
<h3 id="日志文件系统"><a href="#日志文件系统" class="headerlink" title="日志文件系统"></a>日志文件系统</h3><p>日志文件系统（journaling file system）是一个具有<strong>故障恢复能力</strong>的文件系统，在这个文件系统中，因为对目录以及位图的更新信息总是在原始的磁盘日志被更新之前写到<strong>磁盘上的一个连续的日志</strong>上，所以它<strong>保证了数据的完整性</strong>。当发生系统错误时，一个全日志文件系统将会保证磁盘上的数据恢复到<strong>发生系统崩溃前的状态</strong>。同时，它还将覆盖未保存的数据，并将其存在如果计算机没有崩溃的话这些数据可能已经遗失的位置，这是对关键业务应用来说的一个很重要的特性。 </p>
<p>如果不使用日志文件系统，那么一旦系统崩溃，可能导致整个磁盘卷的损坏。</p>
<p>日志文件系统的优点 ：</p>
<ul>
<li>提高了文件的<strong>存储安全性</strong></li>
<li>降低了文件<strong>被破坏的机率</strong></li>
<li>缩短了对磁盘的<strong>扫描时间</strong></li>
<li>减少了磁盘整体<strong>扫描次数</strong></li>
</ul>
<p>Linux支持以下的日志文件系统：</p>
<ul>
<li>ext3/ext4</li>
<li>JFS（IBM）</li>
<li>XFS（ SGI ）</li>
<li>Reiserfs</li>
</ul>
<h3 id="Linux下常见的文件系统"><a href="#Linux下常见的文件系统" class="headerlink" title="Linux下常见的文件系统"></a>Linux下常见的文件系统</h3><ul>
<li>Linux使用的<strong>标准文件系统</strong>：<ul>
<li>ext2/ext3/ext4</li>
</ul>
</li>
<li><strong>交换</strong>文件系统：<ul>
<li>swap</li>
</ul>
</li>
<li><strong>Windows</strong>文件系统：<ul>
<li>FAT32/vfat</li>
</ul>
</li>
<li><strong>网络</strong>文件系统：<ul>
<li>NFS</li>
</ul>
</li>
<li><strong>标准光盘</strong>文件系统：<ul>
<li>iso9660</li>
</ul>
</li>
</ul>
<h2 id="使用Linux文件系统的一般方法"><a href="#使用Linux文件系统的一般方法" class="headerlink" title="使用Linux文件系统的一般方法"></a>使用Linux文件系统的一般方法</h2><ol>
<li>在硬盘上<strong>创建分区或逻辑卷</strong>：<ol>
<li>可以使用fdisk命令创建分区。</li>
<li>可以使用LVM（logical volume manager）的相关命令创建逻辑卷</li>
</ol>
</li>
<li>在分区/LV上<strong>建立文件系统</strong>：<ol>
<li>类似于在Windows下进行格式化操作。</li>
</ol>
</li>
<li><strong>挂装</strong>文件系统到系统中：<ol>
<li>手工挂装：使用mount命令</li>
<li>启动时自动挂装：编辑“/etc/fstab” 添加相应的配置行。</li>
</ol>
</li>
<li><strong>卸装</strong>文件系统：<ol>
<li>对于可移动介质（如u盘、光盘）上的文件系统，当使用完毕可以使用umount命令实施卸装操作。</li>
</ol>
</li>
</ol>
<h2 id="挂装和卸装文件系统"><a href="#挂装和卸装文件系统" class="headerlink" title="挂装和卸装文件系统"></a>挂装和卸装文件系统</h2><p>什么是挂装（挂载，mount）：</p>
<blockquote>
<p>Unix操作系统只有一个单一的目录树结构，该目录树的最顶层就是 <code>/</code> ， 所有可访问文件都必须与这个目录树结构关联。这一点和Windows操作系统不同，在Windows中，每一个硬盘都有独立的目录树结构，比如<code>D:\workspace\algorithm</code> ，<code>C:\Users</code> 这样的。</p>
<p>挂载（mount）这一动作就是把某个设备与目录树中的某个特定位置进行关联，以便于操作系统能够从根目录开始找到这个刚刚加入的设备，从而访问该设备的内的文件数据。（需要注意的是，这里的设备是泛指，既可以指usb、CD-ROM这样真实的设备，也可以是操作系统中的某个目录）。比如，当系统启动的时候，一个特殊的存储设备（通常被称为root 分区）就会与目录树的根进行关联，换句话说，把root分区挂载到了<code>/</code> 上。</p>
<p>再比如说，现在你想访问存储在U盘上的数据，操作系统究竟发生了什么呢？根据前面说的，为了使操作系统找到它，我们必须把usb挂载到目录树结构的某个位置下（比如说，<code>/media/usb/</code>），假设usb设备是<code>/dev/usb</code> ，那么在把usb插入电脑的时候，对应执行的命令就是：</p>
<pre><code>mount /dev/usb /media/usb</code></pre><p>经过这行命令，usb中的文件就对操作系统可见了，比如在usb中的某个文件位于/dir/hello.txt，那么操作系统可访问的对应路径就是/media/usb/dir/hello.txt。当拔出usb时，就执行<code>umount /dev/usb</code> 或<code>umount /media/usb</code> （两者都可行）</p>
<p>Mounting applies to anything that is made accessible as files, not just actual storage devices. 比如Linux系统有一个特殊的文件系统（被称为 proc filesystem）被挂载在<code>/proc</code> 目录下，该文件系统就没有真实的存储设备：<code>/proc</code> 目录下存放的文件保存着正在运行的进程的一些信息。（关于 proc 可以看之前写的那篇文章</p>
</blockquote>
<p><strong>任何可以以文件形式访问的设备的文件系统，都可以被挂载到Linux的文件层次结构（目录树）中，以方便从根目录开始对其进行访问。这里的设备包括但不限于可移动设备、硬盘、甚至内存镜像。</strong></p>
<blockquote>
<p> 挂载的本质就是针对某一设备, 分析出其文件系统结构, 并根据其文件系统类型调用 linux 中相应的驱动, 处理其元数据, 将这些信息附加到 linux 的目录树上呈现出来。</p>
<p> 挂载点就是挂载的目录。</p>
</blockquote>
<p>实际上，Linux系统除了根目录以外的所有文件目录，都是系统启动后挂载进目录树的。比如最先被挂载的是内核文件目录 \boot。</p>
<p><img src="mount.png" alt="已挂载的设备"></p>
<h3 id="挂装文件系统"><a href="#挂装文件系统" class="headerlink" title="挂装文件系统"></a>挂装文件系统</h3><p>挂装文件系统通常使用mount命令，其格式为：</p>
<blockquote>
<p>mount  [选项]  [&lt;分区设备名&gt;]  [&lt;挂装点&gt;]</p>
</blockquote>
<p>常用选项：</p>
<ul>
<li><strong>-t &lt;文件系统类型&gt;：指定文件系统类型</strong></li>
<li>-r ：使用只读方式来挂载 </li>
<li>-a：挂装/etc/fstab文件中记录的设备</li>
<li>-o iocharset=cp936/utf8：使挂装的设备可以显示中文文件名</li>
<li>-o loop：使用回送设备挂装ISO文件和映像文件</li>
</ul>
<pre class="line-numbers language-shell"><code class="language-shell">$ mount 
$ mount -l
$ mount --guess /dev/sda3

# mount –t ext3 /dev/sdb1 /opt
# mount –t vfat /dev/hda6 /mnt/win
# mount –t vfat –o iocharset=cp936  \
   /dev/hda8  /mnt/win2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="卸装文件系统"><a href="#卸装文件系统" class="headerlink" title="卸装文件系统"></a>卸装文件系统</h3><p>卸装文件系统通常使用umount命令，格式为：</p>
<blockquote>
<p>umount &lt; 分区设备名或挂装点&gt;</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell"># umount /dev/hda6
# umount /dev/sdb1
# umount /opt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul>
<li>挂装点目录<strong>必须存在</strong></li>
<li>应该在挂装目录的<strong>上级目录</strong>下进行挂装操作</li>
<li>不该在<strong>同一个挂装点目录</strong>下挂装两个文件系统</li>
<li>当文件系统处于<strong>“busy”状态</strong>时不能进行卸装<ul>
<li>文件系统何时处于“busy”状态<ul>
<li>文件系统上面有打开的文件</li>
<li>某个进程的工作目录在此文件系统上</li>
<li>文件系统上面的缓存文件正在被使用 </li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="可移动介质"><a href="#可移动介质" class="headerlink" title="可移动介质"></a>可移动介质</h2><p>挂装和卸装除了用于自己电脑上的硬盘分区，还可以用于Linux系统访问各种可移动介质——<strong>光盘、DVD、软盘、USB等等</strong>。</p>
<p>可移动介质的挂载点通常在 <strong>/media</strong> 下。</p>
<h3 id="CD和DVD"><a href="#CD和DVD" class="headerlink" title="CD和DVD"></a>CD和DVD</h3><p>CD和DVD可移动设备可以在<strong>Gnome/KDE（Unix桌面环境）</strong>中自动挂载 。也可以使用命令行手工挂载：</p>
<ul>
<li>CD/DVD（只读） <ul>
<li>mount /media/cdrom</li>
</ul>
</li>
<li>CD/DVD（刻录） <ul>
<li>mount /media/cdrecorder</li>
</ul>
</li>
<li>卸载<ul>
<li>umount /media/cdrom</li>
<li>umount /media/cdrecorder</li>
<li>eject —— 卸载并弹出光盘</li>
</ul>
</li>
</ul>
<h3 id="USB存储设备"><a href="#USB存储设备" class="headerlink" title="USB存储设备"></a>USB存储设备</h3><ul>
<li>被内核探测为<strong>SCSI</strong>设备 <ul>
<li>/dev/sdaX、/dev/sdbX、或类似的设备文件 </li>
</ul>
</li>
<li>在<strong>Gnome/KDE</strong>中自动挂载 <ul>
<li>在[计算机]窗口中创建图标</li>
<li>挂载在/media/&lt;设备ID&gt;下 </li>
<li>&lt;设备ID&gt;被厂商内建在设备中</li>
</ul>
</li>
<li>命令行下手动挂载/卸载<ul>
<li>mount -t <strong>vfat</strong> /dev/sda1 /mnt/usb1 </li>
<li>umount /mnt/usb1 </li>
</ul>
</li>
</ul>
<h3 id="软盘"><a href="#软盘" class="headerlink" title="软盘"></a>软盘</h3><ul>
<li><strong>必须</strong>被手工挂载和卸载 <ul>
<li>mount /media/floppy</li>
<li>umount /media/floppy</li>
</ul>
</li>
<li>DOS软盘可以使用<strong>mtools</strong>工具<ul>
<li>透明地挂载和卸载设备 </li>
<li>使用DOS命名规则 <ul>
<li>mdir a:</li>
<li>mcopy  /home/file.txt  a:</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="直接挂装使用映像文件"><a href="#直接挂装使用映像文件" class="headerlink" title="直接挂装使用映像文件"></a>直接挂装使用映像文件</h3><ul>
<li>用mount命令加<strong>-o loop</strong>选项挂装<strong>光盘镜像</strong>文件<ul>
<li>mount -o loop &lt;ISO文件名&gt; &lt;挂装点&gt;</li>
<li>例如：<ul>
<li>mount -o loop CentOS-5.5-i386-bin-DVD.iso /mnt/iso </li>
</ul>
</li>
</ul>
</li>
<li>卸装ISO文件<ul>
<li>umount /mnt/iso</li>
</ul>
</li>
</ul>
<p>IMG文件同理。</p>
<h2 id="系统启动挂装表"><a href="#系统启动挂装表" class="headerlink" title="系统启动挂装表"></a>系统启动挂装表</h2><p>如果每次开机都手动挂载设备，那么显然会非常麻烦。我们可以使用系统启动挂载表，让系统开机时自动对需要挂载的设备进行挂载。</p>
<p>系统启动挂装表的目录在：<strong>/etc/fstab</strong></p>
<p>fstab (file system table，文件系统表) 是一个纯文本文件，开机后，系统会<strong>自动搜索</strong>该文件中的内容，对列于该文件中的文件系统进行<strong>自动挂载</strong>。也可以使用 mount -a 命令手动挂载该文件中的所有设备，这样更新后重新挂载不需要重启。</p>
<ul>
<li>系统重启时保留文件系统体系结构</li>
<li>配置文件系统体系结构</li>
<li>被 mount、fsck 和其它程序使用</li>
<li>使用 <strong>mount -a</strong> 命令挂载 /etc/fstab 中的所有文件系统</li>
<li>可以在设备栏使用文件系统卷标</li>
</ul>
<p>/etc/fstab的每一行说明一个文件系统的挂载信息，每一行由 <strong>6</strong> 列信息组成，列与列之间用 TAB 键隔开。</p>
<ul>
<li>fs_spec：设备或远程文件系统 </li>
<li>fs_file：挂装点目录 </li>
<li>fs_type：文件系统类型 </li>
<li>fs_options：文件系统挂载选项 </li>
<li>fs_dump：被”dump”命令使用来检查一个文件系统应该以多快频率进行转储，若不需要转储则该字段为“0” </li>
<li>fs_pass：被”fsck”命令用来决定在启动时需要被扫描的文件系统的顺序，若无需在启动时扫描则该字段为“0”</li>
</ul>
<p><img src="fstab.png" alt="fstab"></p>
<p>一个fstab的实例如下图所示：</p>
<p><img src="fstab-1.png" alt="fstab实例"></p>
<p>挂装选项有：</p>
<table>
<thead>
<tr>
<th><strong>选项</strong></th>
<th><strong>说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>defaults</td>
<td>使用 rw, suid, dev, exec, auto, nouser 和 async 挂装设备</td>
</tr>
<tr>
<td>acl/noacl</td>
<td>支持/不支持 POSIX Access Control Lists （ACL）</td>
</tr>
<tr>
<td>async</td>
<td>以非同步方式（延迟写）执行文件系统的输入输出操作</td>
</tr>
<tr>
<td>atime/noatime</td>
<td>每次访问文件时都 更新/不更新 文件的访问时间，atime 为默认值，noatime 会提高文件系统的访问速度</td>
</tr>
<tr>
<td>auto/noauto</td>
<td>使用 mount -a 或开机时 会/不会自动挂装</td>
</tr>
<tr>
<td>dev/nodev</td>
<td>可以/不可 解读文件系统上的字符或区块设备</td>
</tr>
<tr>
<td>exec/noexec</td>
<td>可以/不可 执行文件系统上的二进制文件</td>
</tr>
<tr>
<td>suid/nosuid</td>
<td>开启/禁用 SUID和SGID设置位</td>
</tr>
<tr>
<td>user/nouser</td>
<td>允许普通用户/仅超级用户 挂装这个文件系统</td>
</tr>
<tr>
<td>users</td>
<td>使一般用户可以挂装/卸载,用于桌面环境，包含 noexec、nosuid、nodev 选项</td>
</tr>
<tr>
<td>rw/ro</td>
<td>以 读写/只读 方式挂装文件系统。</td>
</tr>
<tr>
<td>remount</td>
<td>重新挂装已挂装的文件系统（通常用于mount命令行）</td>
</tr>
</tbody></table>
<h2 id="交换空间"><a href="#交换空间" class="headerlink" title="交换空间"></a>交换空间</h2><p>Linux系统使用交换分区/文件实现<strong>虚拟内存</strong>技术，它是系统RAM的补充。能够实现内存扩容。</p>
<p>基本设置有：</p>
<ul>
<li>创建交换<strong>分区或者文件</strong> </li>
<li>使用 mkswap 创建<strong>交换文件系统</strong> </li>
<li>在 /etc/fstab 文件中<strong>添加适当的条目</strong> </li>
<li>使用 swapon -a <strong>激活</strong>交换空间 </li>
</ul>
<p>生成交换文件可以使用<strong>dd命令</strong>：</p>
<blockquote>
<p>dd if=/dev/zero of=/swapfile bs=1024 count=X</p>
</blockquote>
<h3 id="dd命令"><a href="#dd命令" class="headerlink" title="dd命令"></a>dd命令</h3><p>从标准输入、文件或设备读取数据，<strong>依照指定的格式</strong>来转换数据， 再输出至文件、设备或标准输出。</p>
<p>常用选项：</p>
<ul>
<li>if=file：输入文件名或设备名，缺省标准输入</li>
<li>of=file：输出文件名或设备名，缺省标准输出</li>
<li>bs=n：同时设置输入输出块的大小为n</li>
<li>count=n：仅仅读取指定的n块数据</li>
</ul>
<pre class="line-numbers language-shell"><code class="language-shell">将软盘的内容制作成映像文件备份到硬盘
# dd if=/dev/fd0　of=fdtemp.img
将硬盘上的软盘映像文件恢复至软盘
# dd if=fdtemp.img　of=/dev/fd0
将硬盘首扇备份到文件bootsector.bin中
# dd if=/dev/sda of=bootsector.bin bs=512 count=1
创建一个800MB的交换文件
# dd if=/dev/zero of=/swapfile bs=4096 count=200000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="ext2-ext3文件系统管理"><a href="#ext2-ext3文件系统管理" class="headerlink" title="ext2/ext3文件系统管理"></a>ext2/ext3文件系统管理</h2><h3 id="创建文件系统"><a href="#创建文件系统" class="headerlink" title="创建文件系统"></a>创建文件系统</h3><p>我们可以使用<strong>mkfs（make file system）</strong>命令在指定的设备上创建文件系统。</p>
<blockquote>
<p>mkfs -t fstype -c  分区设备名</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell"># mkfs -t ext3 -c /dev/hda2
# mkfs -t vfat /dev/hdb2
# mke2fs -c /dev/hda2
# mkfs.ext3 /dev/sda1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="检查文件系统"><a href="#检查文件系统" class="headerlink" title="检查文件系统"></a>检查文件系统</h3><p><strong>fsck（file system check）</strong>是操作系统<strong>扫描文件系统内容检查内部一致性</strong>的工具。</p>
<p>主要功能:</p>
<ul>
<li>检测并修正链接中断的目录</li>
<li>检测并修正错误时间标记</li>
<li>检测并修正指向错误磁盘区域的i-node</li>
</ul>
<p>命令格式：</p>
<blockquote>
<p>fsck [选项] [-t 文件系统类型] &lt;设备名&gt; [特定文件系统的附加选项]</p>
</blockquote>
<p>实例：</p>
<pre class="line-numbers language-shell"><code class="language-shell">检查文件系统，对所有问题回答“yes”
# fsck -t ext3 /dev/sdb2
自动检查并修复文件系统
#  e2fsck  -p  /dev/sda5 
强制进行文件系统检查，标识损坏区块，对所有问题回答“yes”
#  fsck.ext3  -f  -y  /dev/hda2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>注意事项：</p>
<ul>
<li>一般情况下，无需用户手动执行fsck命令。</li>
<li>在系统启动过程中， 一旦系统检测到了不一致就会自动运行fsck命令。</li>
<li>手动执行fsck命令，应该在单用户模式且文件系统被卸装的情况下进行。</li>
</ul>
<h3 id="显示和调整文件系统属性"><a href="#显示和调整文件系统属性" class="headerlink" title="显示和调整文件系统属性"></a>显示和调整文件系统属性</h3><p>显示文件系统属性参数：</p>
<ul>
<li>tune2fs -l  device</li>
<li>dumpe2fs -h device</li>
</ul>
<p>可调整的文件系统属性参数 ：</p>
<ul>
<li>保留块 </li>
<li>默认挂载选项 </li>
<li>fsck 频率</li>
</ul>
<h4 id="tune2fs命令"><a href="#tune2fs命令" class="headerlink" title="tune2fs命令"></a>tune2fs命令</h4><blockquote>
<p>tune2fs [&lt;选项&gt;] &lt;设备名&gt;</p>
</blockquote>
<p>常用选项</p>
<ul>
<li>-c：表示文件系统在 mount 次数达到设定后，需要运行 fsck 检查文件系统。 </li>
<li>-i：文件系统的检查间隔时间。系统在达到时间间隔时，自动检查文件系统。 </li>
<li>-l：显示文件系统的很多参数。 </li>
<li>-j：为 ext2 文件系统添加文件系统日志，转换为 ext3 文件系统。 </li>
<li>-m: 设置保留的空间百分比，预设为 5%。 </li>
<li>-o: 设置默认加载参数。 </li>
<li>-L: 为指定设备设置卷标，不大于 16 字符。</li>
</ul>
<pre class="line-numbers language-shell"><code class="language-shell">设置默认挂载参数
# tune2fs -o acl,user_xattr /dev/sda1
将ext2文件系统转换成ext3文件系统。
#  tune2fs -j /dev/sdb2
将每两次完整性检查之间的装载次数调整为10次。
#  tune2fs -c 10 /dev/sdb5
将每两次完整性检查的时间间隔调整为2个月。
#  tune2fs -i 2m /dev/sdb5
调整指定文件系统的预留块比例为2%。
#  tune2fs -m 2 /dev/sdb5
禁用强制文件系统检查
#  tune2fs -i0 -c0 /dev/sda1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="维护文件系统的卷标"><a href="#维护文件系统的卷标" class="headerlink" title="维护文件系统的卷标"></a>维护文件系统的卷标</h3><p>e2label </p>
<ul>
<li>功能：用于显示或设置指定ext2或ext3分区的卷标。 </li>
<li>格式：# e2label  &lt;设备&gt; [新的卷标名称]</li>
<li>举例：# e2label  /dev/sda10  www</li>
</ul>
<p>findfs </p>
<ul>
<li>功能：在系统中查找指定卷标的文件系统 </li>
<li>格式：# findfs LABEL=&lt;文件系统卷标&gt;</li>
<li>举例：# findfs LABEL=www</li>
</ul>
<h2 id="磁盘限额"><a href="#磁盘限额" class="headerlink" title="磁盘限额"></a>磁盘限额</h2><h3 id="Linux文件系统的组成"><a href="#Linux文件系统的组成" class="headerlink" title="Linux文件系统的组成"></a>Linux文件系统的组成</h3><ul>
<li><strong>超级块</strong>(superblock)：包含了该分区上的文件系统的整体信息，如文件系统大小等</li>
<li><strong>索引结点</strong>(inode)：包含了针对某一个具体文件的几乎全部信息，如存取权限、大小、对应的目录块和数据块等</li>
<li><strong>数据块</strong>(data block)：真正存储文件内容的位置</li>
<li><strong>目录块</strong>(directory block)：包含文件名字及此文件的索引节点号。</li>
</ul>
<h3 id="什么是磁盘限额"><a href="#什么是磁盘限额" class="headerlink" title="什么是磁盘限额"></a>什么是磁盘限额</h3><p>磁盘限额是系统管理员用来<strong>监控和限制用户或组对磁盘的使用</strong>的工具。 </p>
<p>磁盘限额可以从两方面限制：</p>
<ul>
<li>限制用户或组可以拥有的<strong>inode数</strong>（即文件个数） </li>
<li>限制分配给用户或组的磁盘块block的数目，即用户可以占用的<strong>磁盘容量</strong></li>
</ul>
<p>磁盘限额限定的是<strong>一个用户在一个文件系统上的额度</strong>，如果一个用户使用了多个文件系统，那么需要在多个文件系统上对它进行限制。</p>
<p>磁盘限额的限制策略主要有：</p>
<ul>
<li><strong>软限制</strong>：超过此设定值后仍旧可以<strong>继续存储</strong>新的文件，同时系统发出警告信息, 建议用户清理自己的文件，释放出更多的空间。<ul>
<li><strong>时限</strong>：超过软限制多长时间之内（默认为7天）可以继续存储新的文件。</li>
</ul>
</li>
<li><strong>硬限制</strong>：超过此设定值后<strong>不能继续存储</strong>新的文件。</li>
</ul>
<p>磁盘限额使用<strong>quota</strong>工具。磁盘限额的前提有：</p>
<ul>
<li>查看内核是否支持<ul>
<li>默认安装时，是支持quota的。</li>
</ul>
</li>
<li>查看系统中是否安装了quota的RPM<ul>
<li>Red Hat/CentOS 默认已经安装。</li>
</ul>
</li>
<li>查看启动脚本是否在系统启动时打开了quota<ul>
<li>RHEL/CentOS默认已经打开。</li>
</ul>
</li>
</ul>
<h3 id="磁盘限额的步骤"><a href="#磁盘限额的步骤" class="headerlink" title="磁盘限额的步骤"></a>磁盘限额的步骤</h3><ol>
<li><p><strong>启用</strong>文件系统的quota功能：编辑/etc/fstab，为需要启用quota功能的文件系统添加挂载选项，然后重新挂载文件系统：</p>
<blockquote>
<p>LABEL=/home      /home         ext3     defaults,<strong>grpquota,usrquota</strong>    1  2</p>
<p>mount <strong>-o remount</strong> /home</p>
</blockquote>
</li>
<li><p>创建<strong>quota数据库</strong>并开启quota</p>
<blockquote>
<p>创建quota数据库</p>
<p>quotacheck -cmvug /home</p>
<p>开启quota功能</p>
<p>quotaon -avug</p>
</blockquote>
</li>
<li><p>设置<strong>用户和组</strong>的quota</p>
<ul>
<li><p>交互式编辑配额：edquota</p>
<pre class="line-numbers language-shell"><code class="language-shell">#编辑指定用户的配额(user)
edquota [-u]  [ -f filesystem ] <username>
#编辑指定组的配额(group)
edquota -g    [ -f filesystem ] <groupname>
#编辑指定用户的配额时限(time)
edquota -t [-u]  [ -f filesystem ] 
#编辑指定组的配额时限
edquota -t -g    [ -f filesystem ] 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><p>-f filesystem 表示对指定的文件系统设置配额，省略时表示对所有启用了quota的文件系统进行设置。</p>
</li>
<li><p>使用edquota编辑配额，会通过vim打开一个文本文件，直接对里面的文本进行修改并保存退出即可</p>
</li>
</ul>
<pre class="line-numbers language-shell"><code class="language-shell">filesystem blocks soft hard inodes soft hard
/dev/hda3 752 0 0 163 0 0 (修改前)
/dev/hda3 752 5000 8000 163 200 400 (修改后)

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
</li>
</ol>
<pre><code> ```</code></pre><ul>
<li><p>命令式设置配额：setquota</p>
<ul>
<li>指定用户的设置配额<br>setquota [-u] &lt; username &gt; &lt;块软限制 块硬限制 inode软限制 inode硬限制&gt;  &lt;-a|文件系统&gt;</li>
<li>为指定组的设置配额<br>setquota  -g &lt; groupname &gt; &lt;块软限制 块硬限制 inode软限制 inode硬限制&gt;  &lt;-a|文件系统&gt;</li>
<li>为指定用户的设置配额时限<br>setquota -t [-u] &lt;块时限 inode时限&gt;  &lt;-a|文件系统&gt;</li>
<li>为指定组的设置配额时限<br>setquota -t -g   &lt;块时限 inode时限&gt;  &lt;-a|文件系统&gt;</li>
<li>若对所有启用了quota的文件系统设置配额，则使用-a；否则，若对指定的文件系统设置配置，则需要指定文件系统。</li>
</ul>
</li>
<li><p>将参考用户/组的配额复制给其他用户/组</p>
<ul>
<li>edquota  -p protoname……<ul>
<li>edquota [-u] -p &lt; protouname &gt; &lt; username &gt;</li>
</ul>
</li>
<li>setquota -p protoname ……<ul>
<li>setquota [-u] -p &lt; protouname &gt; &lt; username &gt; &lt;-a|filesystem&gt;</li>
</ul>
</li>
</ul>
</li>
</ul>
<ol start="4">
<li><p>查看磁盘限额状况：</p>
<pre class="line-numbers language-shell"><code class="language-shell">查看指定用户或组的quota设置
# quota [-vl] [-u <username>] 
# quota [-vl] [-g <groupname>] 
# quota -q 
显示文件系统的磁盘限额汇总信息
显示指定文件系统的磁盘限额汇总信息
   # repquota [-ugv] filesystem... 
显示所有文件系统的磁盘限额汇总信息
   # repquota [-augv] 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ol>

            </div>
            <hr />

            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            

    <div class="reprint" id="reprint-statement">
        <p class="reprint-tip">
            <i class="fa fa-exclamation-triangle"></i>&nbsp;&nbsp;
            <span>转载规则</span>
        </p>
        
            <div class="center-align">
                <a rel="license" href="https://creativecommons.org/licenses/by/4.0/deed.zh">
                    <img alt=""
                         style="border-width:0"
                         src="https://i.creativecommons.org/l/by/4.0/88x31.png"/>
                </a>
            </div>
            <br/>
            <span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text"
                  property="dct:title" rel="dct:type">
                    《Linux文件系统》
                </span> 由
            <a xmlns:cc="http://creativecommons.org/ns#" href="/2020/05/14/linux-wen-jian-xi-tong/" property="cc:attributionName"
               rel="cc:attributionURL">
                HillZhang
            </a> 采用
            <a rel="license" href="https://creativecommons.org/licenses/by/4.0/deed.zh">
                知识共享署名 4.0 国际许可协议
            </a>进行许可。
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>


        </div>
    </div>

    

    

    

    

    
    <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #vcomments input[type=text],
    #vcomments input[type=email],
    #vcomments input[type=url],
    #vcomments textarea {
        box-sizing: border-box;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #42b983;
        font-weight: 500;
        text-decoration: underline;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div id="vcomments" class="card-content"></div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="/libs/valine/Valine.min.js"></script>
<!-- <script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script> -->

<script>
    new Valine({
        el: '#vcomments',
        appId: 'uCuovwWUzxnygDdXy6SPs97E-gzGzoHsz',
        appKey: 'oroAoITTPFXepwWrR1qGq7b7',
        notify: 'false' === 'true',
        verify: 'false' === 'true',
        visitor: 'false' === 'true',
        avatar: 'wavatar',
        pageSize: '10',
        lang: 'zh-cn',
        placeholder: '欢迎和我一起交流！'
    });
</script>

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fa fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2020/05/14/linux-zhang-hu-guan-li/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/26.jpg" class="responsive-img" alt="Linux账户管理">
                        
                        <span class="card-title">Linux账户管理</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="fa fa-clock-o fa-fw icon-date"></i>2020-05-14
                        </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Linux/" class="post-category" target="_blank">
                                    Linux
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Linux/" target="_blank">
                        <span class="chip bg-color">Linux</span>
                    </a>
                    
                    <a href="/tags/操作系统/" target="_blank">
                        <span class="chip bg-color">操作系统</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fa fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2020/05/05/linux-de-grep-awk-he-sed-ming-ling/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/22.jpg" class="responsive-img" alt="Linux的grep、awk和sed命令">
                        
                        <span class="card-title">Linux的grep、awk和sed命令</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            Linux的grep、awk和sed命令grep、awk和sed命令是Linux下比较常用的三种用于文本相关操作的命令，很有学习的必要。通常情况下，Linux运用在服务器上，而服务器运行的程序经常会产生日志，或者其它很大的文本文件，我们使用
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2020-05-05
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Linux/" class="post-category" target="_blank">
                                    Linux
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Linux/" target="_blank">
                        <span class="chip bg-color">Linux</span>
                    </a>
                    
                    <a href="/tags/操作系统/" target="_blank">
                        <span class="chip bg-color">操作系统</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: HillZhang的博客<br />'
            + '作者: HillZhang<br />'
            + '链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () { bodyElement.removeChild(newdiv); }, 200);
    });
</script>

    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="fa fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fa fa-list"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h1, h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h1, h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).slideUp(500);
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).slideDown(500);
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>
    

</main>


<script src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$', '$'], ['\(', '\)']]}
    });
</script>

<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>
<!-- 代码语言 -->
<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>
<!-- 代码块复制 -->
<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>
<script type="text/javascript" src="/libs/codeBlock/clipboard.min.js"></script>
<!-- 代码块收缩 -->
<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script> 
<!-- 代码块折行 -->
<style type="text/css">code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }</style>


    <footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            &copy; 2019-2020 章岳. 版权所有

            
            &nbsp;<i class="fa fa-area-chart"></i>&nbsp;站点总字数:&nbsp;
            <span class="white-color">247.2k</span>
            

            <br>
            <span id="sitetime"></span>

            
            
        </div>
        <div class="col s12 m4 l4 social-link ">
    <a href="https://github.com/HillZhang1999" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fa fa-github"></i>
    </a>



    <a href="mailto:471791641@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fa fa-envelope-open"></i>
    </a>





    <a href="http://wpa.qq.com/msgrd?v=3&uin=471791641&site=qq&menu=yes" class="tooltipped" target="_blank" data-tooltip="访问我的知乎" data-position="top" data-delay="50">
        <i class="fa fa-qq"></i>
    </a>





    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fa fa-rss"></i>
    </a>
</div>
    </div>
</footer>

<div class="progress-bar"></div>

<!-- 不蒜子计数初始值纠正 -->
<script>
    $(document).ready(function () {

        var int = setInterval(fixCount, 50);
        var pvcountOffset = 80000;
        var uvcountOffset = 20000;

        function fixCount() {
            if (document.getElementById("busuanzi_container_site_pv").style.display != "none") {
                $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + pvcountOffset);
                clearInterval(int);
            }
            if ($("#busuanzi_container_site_pv").css("display") != "none") {
                $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + uvcountOffset); // 加上初始数据 
                clearInterval(int);
            }
        }
    });
</script>

<script language=javascript>
    function siteTime() {
        window.setTimeout("siteTime()", 1000);
        var seconds = 1000;
        var minutes = seconds * 60;
        var hours = minutes * 60;
        var days = hours * 24;
        var years = days * 365;
        var today = new Date();
        var todayYear = today.getFullYear();
        var todayMonth = today.getMonth() + 1;
        var todayDate = today.getDate();
        var todayHour = today.getHours();
        var todayMinute = today.getMinutes();
        var todaySecond = today.getSeconds();
        /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
        year - 作为date对象的年份，为4位年份值
        month - 0-11之间的整数，做为date对象的月份
        day - 1-31之间的整数，做为date对象的天数
        hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
        minutes - 0-59之间的整数，做为date对象的分钟数
        seconds - 0-59之间的整数，做为date对象的秒数
        microseconds - 0-999之间的整数，做为date对象的毫秒数 */
        var t1 = Date.UTC(2020, 03, 11, 00, 00, 00); //北京时间2018-2-13 00:00:00
        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
        var diff = t2 - t1;
        var diffYears = Math.floor(diff / years);
        var diffDays = Math.floor((diff / days) - diffYears * 365);
        var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
        var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) / minutes);
        var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours - diffMinutes * minutes) / seconds);
        document.getElementById("sitetime").innerHTML = "本站已运行 " + diffYears + " 年 " + diffDays + " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
    }/*因为建站时间还没有一年，就将之注释掉了。需要的可以取消*/
    siteTime();
</script>

    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <script type="text/javascript"> var OriginTitile = document.title, st; document.addEventListener("visibilitychange", function () { document.hidden ? (document.title = "Σ(っ °Д °;)っ喔哟，崩溃啦！", clearTimeout(st)) : (document.title = "φ(゜▽゜*)♪咦，又好了！", st = setTimeout(function () { document.title = OriginTitile }, 3e3)) })
    </script>

    <!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', '');
</script>



    
    <script src="/libs/others/clicklove.js"></script>
    

    

    <!-- 雪花特效 -->
    

</body>

</html>